<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#facc15">
    <meta name="description" content="Enqu√™tes et Psychopathes - Jeu d'enqu√™tes criminelles">
    <title>Enqu√™tes et Psychopathes</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Rye&family=Special+Elite&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }
        
        body {
            font-family: 'Special Elite', cursive;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            background: linear-gradient(to bottom right, #18181b, #171717, #000);
            min-height: 100vh;
        }
        
        .hidden { display: none !important; }
        
        @keyframes marquee {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .animate-marquee {
            animation: marquee 20s linear infinite;
            display: inline-block;
        }
        
        .bg-noise {
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
        }
        
        input, button {
            font-size: 16px !important;
        }
        
        button {
            min-height: 44px;
            cursor: pointer;
            font-family: 'Special Elite', cursive;
        }
        
        button:active {
            transform: scale(0.95);
        }
        
        .title-font { font-family: 'Rye', serif; }
        
        @media (max-width: 640px) {
            .text-7xl { font-size: 3rem !important; }
            .text-6xl { font-size: 2.5rem !important; }
            .text-5xl { font-size: 2rem !important; }
        }
    </style>
</head>
<body>

<!-- √âCRAN DE LOGIN -->
<div id="loginScreen">
    <div style="position: relative; min-height: 100vh; overflow: hidden; background: linear-gradient(to bottom right, #18181b, #171717, #000);">
        
        <!-- D√©corations arri√®re-plan -->
        <div style="position: absolute; inset: 0; opacity: 0.05; pointer-events: none;">
            <div style="position: absolute; top: 5rem; left: 2.5rem; font-size: 6rem; transform: rotate(12deg);">üîç</div>
            <div style="position: absolute; bottom: 5rem; right: 5rem; font-size: 6rem; transform: rotate(-12deg);">üíÄ</div>
            <div style="position: absolute; top: 33%; right: 25%; font-size: 4rem;">üë§</div>
            <div style="position: absolute; top: 10rem; right: 2.5rem; font-size: 5rem; transform: rotate(45deg);">üß†</div>
            <div style="position: absolute; bottom: 10rem; left: 5rem; font-size: 4.5rem; transform: rotate(-12deg);">üé≠</div>
            <div style="position: absolute; top: 50%; left: 33%; font-size: 4rem; transform: rotate(90deg);">‚è∞</div>
            <div style="position: absolute; bottom: 8rem; right: 33%; font-size: 4.5rem;">üíä</div>
            <div style="position: absolute; top: 25%; left: 50%; font-size: 3rem; opacity: 0.4;">ü™û</div>
            <div style="position: absolute; bottom: 25%; left: 4rem; font-size: 4rem; transform: rotate(45deg);">üëÅÔ∏è</div>
            <div style="position: absolute; top: 66%; right: 4rem; font-size: 3rem; transform: rotate(-30deg);">üåÄ</div>
        </div>
        
        <div class="bg-noise" style="position: absolute; inset: 0; opacity: 0.1; pointer-events: none;"></div>
        
        <!-- Bandeau jaune -->
        <div style="position: absolute; top: 0; left: 0; right: 0; height: 3rem; background: linear-gradient(to right, #facc15, #eab308, #facc15); transform: rotate(-2deg); opacity: 0.9; overflow: hidden; display: flex; align-items: center; justify-content: center;">
            <div class="animate-marquee" style="color: black; font-weight: bold; font-size: 0.875rem; letter-spacing: 0.1em; white-space: nowrap;">
                ‚ö†Ô∏è SC√àNE DE CRIME ... ET DE FOLIE ‚ö†Ô∏è SC√àNE DE CRIME ... ET DE FOLIE ‚ö†Ô∏è SC√àNE DE CRIME ... ET DE FOLIE ‚ö†Ô∏è SC√àNE DE CRIME ... ET DE FOLIE ‚ö†Ô∏è
            </div>
        </div>

        <!-- Contenu principal -->
        <div style="position: relative; z-index: 10; max-width: 1200px; margin: 0 auto; padding: 6rem 1rem 2rem;">
            
            <!-- Titre -->
            <div style="text-align: center; margin-bottom: 4rem;">
                <h1 class="title-font text-7xl" style="color: #fef3c7; margin-bottom: 1rem; text-shadow: 4px 4px 8px rgba(0,0,0,0.8);">
                    ENQU√äTES
                </h1>
                <h2 class="title-font text-5xl" style="color: #facc15; margin-bottom: 1.5rem; text-shadow: 3px 3px 6px rgba(0,0,0,0.8);">
                    & Psychopathes
                </h2>
                <p style="color: #fcd34d; font-size: 1.125rem; margin-bottom: 1.5rem; font-style: italic; max-width: 600px; margin-left: auto; margin-right: auto; text-shadow: 2px 2px 4px rgba(0,0,0,0.8);">
                    "Plonger dans l'esprit des tortur√©s... avant qu'ils ne plongent dans le v√¥tre"
                </p>
                <div style="display: inline-block; background: #7f1d1d; padding: 0.5rem 1.5rem; transform: rotate(-2deg);">
                    <p style="color: #fef3c7; font-size: 0.875rem; letter-spacing: 0.1em;">
                        DOSSIER CONFIDENTIEL
                    </p>
                </div>
            </div>

            <!-- Box de login -->
            <div style="max-width: 48rem; margin: 0 auto; background: #27272a; border: 4px solid #d97706; border-radius: 0.5rem; padding: 2rem; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25); position: relative; overflow: hidden;">
                
                <div style="position: absolute; top: 1rem; right: 1rem; opacity: 0.1; width: 6rem; height: 6rem; border-radius: 50%; border: 8px solid #d97706;"></div>
                <div style="position: absolute; bottom: 1rem; left: 1rem; opacity: 0.05; font-size: 4rem;">üß†</div>
                <div style="position: absolute; top: 50%; left: 0.5rem; opacity: 0.05; font-size: 3rem; transform: rotate(-12deg);">üé≠</div>

                <div style="position: relative; z-index: 10;">
                    <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1.5rem;">
                        <svg style="width: 2rem; height: 2rem; color: #facc15;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                        </svg>
                        <h3 style="font-size: 1.5rem; color: #fef3c7; font-weight: bold;">
                            IDENTIFICATION D√âTECTIVE
                        </h3>
                    </div>

                    <div style="background: #450a0a; border: 2px solid #991b1b; border-radius: 0.25rem; padding: 1rem; margin-bottom: 1.5rem;">
                        <div style="display: flex; gap: 0.75rem;">
                            <svg style="width: 1.5rem; height: 1.5rem; color: #facc15; flex-shrink: 0; margin-top: 0.25rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                            </svg>
                            <div>
                                <p style="color: #fef3c7; font-weight: bold; margin-bottom: 0.5rem; font-size: 1rem;">
                                    ‚ö†Ô∏è ATTENTION : Protocole sans mot de passe
                                </p>
                                <p style="color: #fef9c3; font-size: 0.875rem; margin-bottom: 0.5rem;">
                                    Ce pseudo sera votre SEUL moyen de vous reconnecter. Choisissez-le bien et m√©morisez-le !
                                </p>
                                <p style="color: #fde047; font-size: 0.75rem; font-style: italic;">
                                    Conseil : Personnalisez votre pseudo pour le rendre unique et m√©morable
                                </p>
                            </div>
                        </div>
                    </div>

                    <div style="margin-bottom: 1rem;">
                        <p style="color: #fde68a; font-size: 0.875rem; margin-bottom: 0.5rem;">
                            Exemples de pseudos cr√©atifs :
                        </p>
                        <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
                            <span style="padding: 0.25rem 0.75rem; background: #3f3f46; color: #fcd34d; font-size: 0.75rem; border-radius: 0.25rem; border: 1px solid #78350f;">SherlockModerne</span>
                            <span style="padding: 0.25rem 0.75rem; background: #3f3f46; color: #fcd34d; font-size: 0.75rem; border-radius: 0.25rem; border: 1px solid #78350f;">Inspecteur_42</span>
                            <span style="padding: 0.25rem 0.75rem; background: #3f3f46; color: #fcd34d; font-size: 0.75rem; border-radius: 0.25rem; border: 1px solid #78350f;">Miss_Marple_2.0</span>
                            <span style="padding: 0.25rem 0.75rem; background: #3f3f46; color: #fcd34d; font-size: 0.75rem; border-radius: 0.25rem; border: 1px solid #78350f;">Le_Limier</span>
                            <span style="padding: 0.25rem 0.75rem; background: #3f3f46; color: #fcd34d; font-size: 0.75rem; border-radius: 0.25rem; border: 1px solid #78350f;">Columbo_Jr</span>
                        </div>
                    </div>

                    <div style="margin-bottom: 1.5rem;">
                        <label style="display: block; color: #fde68a; margin-bottom: 0.5rem; font-size: 0.875rem;">
                            Votre pseudo de d√©tective :
                        </label>
                        <input
                            type="text"
                            id="pseudoInput"
                            placeholder="Entrez votre pseudo unique..."
                            style="width: 100%; padding: 0.75rem 1rem; background: #18181b; border: 2px solid #d97706; border-radius: 0.25rem; color: #fef3c7; font-family: 'Special Elite', cursive;"
                        />
                        <p id="pseudoStatus" style="margin-top: 0.5rem; font-size: 0.875rem;"></p>
                    </div>

                    <button
                        id="loginBtn"
                        style="width: 100%; padding: 1rem; background: linear-gradient(to right, #ca8a04, #d97706); color: black; font-weight: bold; font-size: 1.125rem; border-radius: 0.25rem; border: 2px solid #facc15; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1);"
                    >
                        üîç SE CONNECTER
                    </button>
                </div>
            </div>

            <div style="text-align: center; margin-top: 3rem; color: #fcd34d; font-size: 0.875rem;">
                <p>Score maximum possible : 100 points ‚Ä¢ 7 enqu√™tes √† r√©soudre</p>
                <p style="font-size: 0.75rem; color: #facc15; font-style: italic; margin-top: 0.5rem; display: flex; align-items: center; justify-content: center; gap: 0.5rem; flex-wrap: wrap;">
                    <span>üß†</span>
                    <span>Chaque esprit criminel r√©v√®le ses secrets... √† qui sait les chercher</span>
                    <span>üîç</span>
                </p>
            </div>
        </div>
    </div>
</div>

<!-- √âCRAN DE JEU -->
<div id="gameScreen" class="hidden">
    <div style="position: relative; min-height: 100vh;">
        <div class="bg-noise" style="position: absolute; inset: 0; opacity: 0.05; pointer-events: none;"></div>
        
        <!-- Header sticky -->
        <div id="gameHeader" style="position: sticky; top: 0; z-index: 50; background: linear-gradient(to right, #facc15, #eab308, #facc15); padding: 0.75rem; border-bottom: 4px solid black; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1);">
            <div style="max-width: 1200px; margin: 0 auto; display: flex; flex-wrap: wrap; align-items: center; justify-content: space-between; gap: 0.5rem;">
                <div style="display: flex; flex-wrap: wrap; align-items: center; gap: 0.5rem;">
                    <div style="background: black; border-radius: 9999px; padding: 0.5rem 1rem; display: flex; align-items: center; gap: 0.5rem;">
                        <svg style="width: 1.25rem; height: 1.25rem; color: #facc15;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                        </svg>
                        <span id="headerPseudo" style="color: #facc15; font-weight: bold; font-size: 0.875rem;"></span>
                    </div>
                    
                    <div style="background: black; border-radius: 9999px; padding: 0.5rem 1rem;">
                        <span style="color: #fcd34d; font-size: 0.75rem; margin-right: 0.5rem;">SCORE :</span>
                        <span id="headerScore" style="color: #facc15; font-weight: bold; font-size: 1.125rem;">0</span>
                        <span style="color: #fcd34d; font-size: 0.75rem; margin-left: 0.25rem;">/ 100</span>
                    </div>
                </div>

                <button
                    onclick="showStats()"
                    style="padding: 0.5rem 1.5rem; background: black; color: #facc15; font-weight: bold; border-radius: 0.5rem; border: 2px solid #ca8a04; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); display: flex; align-items: center; gap: 0.75rem;"
                >
                    <svg style="width: 1.25rem; height: 1.25rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z" />
                    </svg>
                    <div style="text-align: left;">
                        <div style="font-size: 0.75rem; color: #fcd34d;">ACC√âDER AU</div>
                        <div style="font-size: 0.875rem;">TOP 10 & STATISTIQUES</div>
                    </div>
                </button>
            </div>
        </div>

        <!-- Contenu -->
        <div style="max-width: 1200px; margin: 0 auto; padding: 3rem 1rem;">
            <div style="text-align: center; margin-bottom: 3rem;">
                <h1 class="title-font text-6xl" style="color: #fef3c7; margin-bottom: 1rem; text-shadow: 3px 3px 6px rgba(0,0,0,0.8);">
                    DOSSIERS D'ENQU√äTE
                </h1>
                <div style="display: inline-block; background: #7f1d1d; padding: 0.25rem 1rem; transform: rotate(1deg);">
                    <p style="color: #fef3c7; font-size: 0.75rem; letter-spacing: 0.1em;">
                        STRICTEMENT CONFIDENTIEL
                    </p>
                </div>
            </div>

            <div id="chaptersContainer" style="max-width: 1200px; margin: 0 auto;"></div>

            <div style="max-width: 1200px; margin: 3rem auto 0; background: #27272a; border: 4px solid #ca8a04; border-radius: 0.5rem; padding: 2rem; text-align: center; position: relative; overflow: hidden;">
                <div style="position: absolute; inset: 0; background: linear-gradient(to bottom right, rgba(113, 63, 18, 0.1), rgba(127, 29, 29, 0.1));"></div>
                <div style="position: relative; z-index: 10;">
                    <p style="color: #fcd34d; font-size: 1.125rem; margin-bottom: 0.5rem;">
                        SCORE TOTAL ACTUEL
                    </p>
                    <div id="totalScore" style="font-size: 4rem; font-weight: bold; color: #facc15; margin-bottom: 0.5rem;">
                        0
                    </div>
                    <p style="color: #fde68a; font-size: 1.5rem;">
                        / 100 points
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal de confirmation -->
<div id="confirmModal" class="hidden" style="position: fixed; inset: 0; background: rgba(0,0,0,0.8); display: flex; align-items: center; justify-content: center; z-index: 100; padding: 1rem;">
    <div style="background: #27272a; border: 4px solid #991b1b; border-radius: 0.5rem; padding: 2rem; max-width: 28rem; width: 100%; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25);">
        <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1.5rem;">
            <svg style="width: 2rem; height: 2rem; color: #facc15;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
            </svg>
            <h3 style="font-size: 1.5rem; color: #fef3c7; font-weight: bold;">
                CONFIRMATION
            </h3>
        </div>
        
        <div style="background: #450a0a; border: 2px solid #991b1b; border-radius: 0.25rem; padding: 1rem; margin-bottom: 1.5rem;">
            <p id="confirmText" style="color: #fef3c7; margin-bottom: 1rem; font-size: 1rem;"></p>
            <p style="color: #fca5a5; font-weight: bold; font-size: 1rem;">
                Cette action est D√âFINITIVE et ne pourra pas √™tre modifi√©e !
            </p>
        </div>

        <div style="display: flex; gap: 1rem;">
            <button
                onclick="closeConfirmModal()"
                style="flex: 1; padding: 0.75rem; background: #3f3f46; color: #fef3c7; font-weight: bold; border-radius: 0.25rem; border: 2px solid #52525b;"
            >
                ANNULER
            </button>
            <button
                id="confirmBtn"
                style="flex: 1; padding: 0.75rem; background: linear-gradient(to right, #ca8a04, #d97706); color: black; font-weight: bold; border-radius: 0.25rem; border: 2px solid #facc15;"
            >
                VALIDER
            </button>
        </div>
    </div>
</div>

<!-- √âCRAN STATS -->
<div id="statsScreen" class="hidden">
    <div style="position: relative; min-height: 100vh;">
        <div class="bg-noise" style="position: absolute; inset: 0; opacity: 0.05; pointer-events: none;"></div>
        
        <!-- Header -->
        <div style="position: sticky; top: 0; z-index: 50; background: linear-gradient(to right, #facc15, #eab308, #facc15); padding: 0.75rem; border-bottom: 4px solid black; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1);">
            <div style="max-width: 1200px; margin: 0 auto; display: flex; flex-wrap: wrap; align-items: center; justify-content: space-between; gap: 0.5rem;">
                <div style="display: flex; flex-wrap: wrap; align-items: center; gap: 0.5rem;">
                    <div style="background: black; border-radius: 9999px; padding: 0.5rem 1rem; display: flex; align-items: center; gap: 0.5rem;">
                        <svg style="width: 1.25rem; height: 1.25rem; color: #facc15;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                        </svg>
                        <span id="statsPseudo" style="color: #facc15; font-weight: bold; font-size: 0.875rem;"></span>
                    </div>
                    
                    <div style="background: black; border-radius: 9999px; padding: 0.5rem 1rem;">
                        <span style="color: #fcd34d; font-size: 0.75rem; margin-right: 0.5rem;">SCORE :</span>
                        <span id="statsScore" style="color: #facc15; font-weight: bold; font-size: 1.125rem;">0</span>
                        <span style="color: #fcd34d; font-size: 0.75rem; margin-left: 0.25rem;">/ 100</span>
                    </div>
                </div>

                <button
                    onclick="showGame()"
                    style="padding: 0.5rem 1.5rem; background: black; color: #facc15; font-weight: bold; border-radius: 0.5rem; border: 2px solid #ca8a04; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); display: flex; align-items: center; gap: 0.75rem;"
                >
                    <svg style="width: 1.25rem; height: 1.25rem;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                    </svg>
                    <span style="font-size: 0.875rem;">RETOUR AUX DOSSIERS</span>
                </button>
            </div>
        </div>

        <!-- Contenu stats -->
        <div style="max-width: 1200px; margin: 0 auto; padding: 3rem 1rem;">
            <div style="text-align: center; margin-bottom: 3rem;">
                <h1 class="title-font text-6xl" style="color: #fef3c7; margin-bottom: 1rem; text-shadow: 3px 3px 6px rgba(0,0,0,0.8);">
                    RAPPORT STATISTIQUE
                </h1>
                <div style="display: inline-block; background: #7f1d1d; padding: 0.25rem 1rem; transform: rotate(-1deg);">
                    <p style="color: #fef3c7; font-size: 0.75rem; letter-spacing: 0.1em;">
                        CLASSEMENT G√âN√âRAL ‚Ä¢ <span id="totalPlayers">0</span> D√âTECTIVES
                    </p>
                </div>
            </div>

            <!-- Score global -->
            <div style="max-width: 64rem; margin: 0 auto 3rem; background: #27272a; border: 4px solid #ca8a04; border-radius: 0.5rem; padding: 2rem;">
                <div style="display: grid; grid-template-columns: 1fr; gap: 2rem;">
                    <div style="text-align: center;">
                        <p style="color: #fcd34d; font-size: 1.125rem; margin-bottom: 0.5rem;">VOTRE SCORE</p>
                        <div id="myTotalScore" style="font-size: 3.75rem; font-weight: bold; color: #facc15; margin-bottom: 0.5rem;">0</div>
                        <p style="color: #fde68a; font-size: 1.25rem;">/ 100 points</p>
                    </div>
                    
                    <div style="text-align: center;">
                        <p style="color: #fcd34d; font-size: 1.125rem; margin-bottom: 0.5rem;">MOYENNE G√âN√âRALE</p>
                        <div id="avgScore" style="font-size: 3.75rem; font-weight: bold; color: #fbbf24; margin-bottom: 0.5rem;">0</div>
                        <p style="color: #fde68a; font-size: 1.25rem;">/ 100 points</p>
                    </div>
                </div>

                <div style="margin-top: 1.5rem;">
                    <div style="background: #3f3f46; border-radius: 9999px; height: 1.5rem; overflow: hidden; position: relative;">
                        <div id="myScoreBar" style="background: linear-gradient(to right, #ca8a04, #d97706); height: 100%; transition: width 1s; display: flex; align-items: center; justify-content: flex-end; padding-right: 0.5rem;">
                            <span style="color: black; font-size: 0.75rem; font-weight: bold;">VOUS</span>
                        </div>
                        <div id="avgScoreBar" style="position: absolute; top: 0; left: 0; height: 100%; border-right: 4px solid #ef4444; transition: width 1s;"></div>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: 0.5rem; font-size: 0.75rem; color: #fcd34d;">
                        <span>0</span>
                        <span style="color: #f87171;">‚Üë Moyenne</span>
                        <span>100</span>
                    </div>
                </div>
            </div>

            <!-- Top 10 -->
            <div style="max-width: 64rem; margin: 0 auto;">
                <div style="background: #27272a; border: 4px solid #d97706; border-radius: 0.5rem; padding: 2rem; position: relative; overflow: hidden;">
                    
                    <h2 class="title-font" style="font-size: 1.875rem; color: #fef3c7; margin-bottom: 1.5rem; text-align: center; position: relative; z-index: 10;">
                        üèÜ TOP 10 D√âTECTIVES üèÜ
                    </h2>
                    
                    <div id="top10Container" style="position: relative; z-index: 10;"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Configuration
const CHAPTERS = [
    { id: 1, title: "Madame BONPOIL encaisse bien", difficulty: 2.1, maxPoints: 10, values: [0, 10] },
    { id: 2, title: "Mort d'un fonctionnaire, pri√®re de patienter.", difficulty: 3.5, maxPoints: 15, values: [0, 15] },
    { id: 3, title: "Une pute en moins", difficulty: 3.1, maxPoints: 15, values: [0, 15] },
    { id: 4, title: "L'encre de la vengeance", difficulty: 1.7, maxPoints: 5, values: [0, 5] },
    { id: 5, title: "Potins de Stars", difficulty: 3.2, maxPoints: 10, values: [0, 3, 7, 10] },
    { id: 6, title: "Toc toc toc", difficulty: 4.8, maxPoints: 25, values: [0, 12, 25] },
    { id: 7, title: "Choisis ta folie", difficulty: 4.5, maxPoints: 20, values: [0, 10, 20] }
];

// √âtat de l'application
let currentUser = null;
let scores = {};
let pendingScore = null;

// Database
const DB = {
    getUsers: () => JSON.parse(localStorage.getItem('enquetes_psychopathes_users') || '[]'),
    saveUser: (user) => {
        const users = DB.getUsers();
        users.push(user);
        localStorage.setItem('enquetes_psychopathes_users', JSON.stringify(users));
    },
    getUser: (pseudo) => DB.getUsers().find(u => u.pseudo === pseudo),
    updateUserScore: (pseudo, scores) => {
        const users = DB.getUsers();
        const user = users.find(u => u.pseudo === pseudo);
        if (user) {
            user.scores = scores;
            localStorage.setItem('enquetes_psychopathes_users', JSON.stringify(users));
        }
    },
    pseudoExists: (pseudo) => DB.getUsers().some(u => u.pseudo === pseudo)
};

// Login
document.getElementById('pseudoInput').addEventListener('input', function(e) {
    const pseudo = e.target.value.trim();
    const statusEl = document.getElementById('pseudoStatus');
    
    if (pseudo.length > 0) {
        const exists = DB.pseudoExists(pseudo);
        statusEl.textContent = exists 
            ? '‚úì Pseudo existant - Acc√®s √† votre dossier'
            : '‚úì Ce pseudo est disponible - Nouveau dossier';
        statusEl.style.color = exists ? '#facc15' : '#4ade80';
    } else {
        statusEl.textContent = '';
    }
});

document.getElementById('pseudoInput').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        handleLogin();
    }
});

document.getElementById('loginBtn').addEventListener('click', handleLogin);

function handleLogin() {
    const pseudo = document.getElementById('pseudoInput').value.trim();
    if (!pseudo) return;
    
    const existingUser = DB.getUser(pseudo);
    if (existingUser) {
        currentUser = existingUser;
        scores = existingUser.scores || {};
    } else {
        currentUser = { pseudo, scores: {}, createdAt: new Date().toISOString() };
        DB.saveUser(currentUser);
        scores = {};
    }
    
    showGame();
}

// Navigation
function showGame() {
    document.getElementById('loginScreen').classList.add('hidden');
    document.getElementById('statsScreen').classList.add('hidden');
    document.getElementById('gameScreen').classList.remove('hidden');
    
    document.getElementById('headerPseudo').textContent = currentUser.pseudo;
    updateScores();
    renderChapters();
}

function showStats() {
    document.getElementById('loginScreen').classList.add('hidden');
    document.getElementById('gameScreen').classList.add('hidden');
    document.getElementById('statsScreen').classList.remove('hidden');
    
    document.getElementById('statsPseudo').textContent = currentUser.pseudo;
    renderStats();
}

// Rendu des chapitres
function renderChapters() {
    const container = document.getElementById('chaptersContainer');
    container.innerHTML = '';
    
    CHAPTERS.forEach((chapter, index) => {
        const isCompleted = scores[chapter.id] !== undefined;
        const myScore = scores[chapter.id] || 0;
        
        const chapterDiv = document.createElement('div');
        chapterDiv.style.cssText = 'background: #27272a; border: 2px solid #d97706; border-radius: 0.5rem; padding: 1.5rem; margin-bottom: 1.5rem; box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1); animation: fadeIn 0.6s ease-out backwards;';
        chapterDiv.style.animationDelay = `${index * 0.1}s`;
        
        const stars = '‚òÖ'.repeat(Math.round(chapter.difficulty)) + '‚òÜ'.repeat(5 - Math.round(chapter.difficulty));
        
        chapterDiv.innerHTML = `
            <div style="display: flex; flex-direction: column; gap: 1rem;">
                <div style="flex: 1;">
                    <div style="display: flex; align-items: start; gap: 0.75rem; margin-bottom: 0.5rem; flex-wrap: wrap;">
                        <div style="background: #7f1d1d; padding: 0.25rem 0.75rem; border-radius: 0.25rem;">
                            <span style="color: #facc15; font-weight: bold; font-size: 0.875rem;">DOSSIER #${chapter.id}</span>
                        </div>
                        ${isCompleted ? `
                        <div style="background: #14532d; padding: 0.25rem 0.75rem; border-radius: 0.25rem; animation: pulse 2s ease-in-out infinite;">
                            <span style="color: #86efac; font-weight: bold; font-size: 0.75rem;">‚úì ENQU√äTE FINALIS√âE</span>
                        </div>
                        ` : ''}
                    </div>
                    
                    <h3 style="font-size: 1.5rem; color: #fef3c7; font-weight: bold; margin-bottom: 0.5rem;">
                        ${chapter.title}
                    </h3>
                    
                    <div style="display: flex; align-items: center; gap: 1rem; font-size: 0.875rem; flex-wrap: wrap;">
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <span style="color: #fcd34d;">Difficult√©:</span>
                            <span style="color: ${Math.round(chapter.difficulty) <= 2 ? '#facc15' : Math.round(chapter.difficulty) <= 3 ? '#fb923c' : '#ef4444'};">
                                ${stars}
                            </span>
                            <span style="color: #facc15; font-weight: bold;">${chapter.difficulty}/5</span>
                        </div>
                        
                        <div style="color: #fcd34d;">
                            Max: <span style="color: #facc15; font-weight: bold;">${chapter.maxPoints} pts</span>
                        </div>
                    </div>
                </div>

                <div style="display: flex; flex-direction: column; align-items: center; gap: 0.75rem;">
                    ${isCompleted ? `
                        <div style="text-align: center;">
                            ${myScore === chapter.maxPoints ? '<div style="font-size: 3rem; margin-bottom: 0.5rem; animation: bounce 1s ease-in-out infinite;">üèÜ</div>' : ''}
                            <div style="font-size: 2.5rem; font-weight: bold; color: #4ade80; margin-bottom: 0.25rem;">
                                ${myScore}
                            </div>
                            <div style="font-size: 0.75rem; color: #fcd34d;">
                                points obtenus
                            </div>
                        </div>
                    ` : `
                        <div style="width: 100%;">
                            <p style="color: #fcd34d; font-size: 0.875rem; margin-bottom: 0.5rem; text-align: center;">
                                Votre score :
                            </p>
                            <div style="display: flex; gap: 0.5rem; justify-content: center; flex-wrap: wrap;">
                                ${chapter.values.map(value => `
                                    <button
                                        onclick="selectScore(${chapter.id}, ${value})"
                                        style="padding: 0.75rem 1.5rem; background: linear-gradient(to bottom, #ca8a04, #d97706); color: black; font-weight: bold; border-radius: 0.25rem; border: 2px solid #facc15; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); font-size: 1rem; min-width: 60px;"
                                    >
                                        ${value}
                                    </button>
                                `).join('')}
                            </div>
                        </div>
                    `}
                </div>
            </div>
        `;
        
        container.appendChild(chapterDiv);
    });
}

// S√©lection de score
function selectScore(chapterId, value) {
    if (scores[chapterId] !== undefined) return;
    
    const chapter = CHAPTERS.find(c => c.id === chapterId);
    pendingScore = { chapterId, value };
    
    document.getElementById('confirmText').innerHTML = `
        ‚ö†Ô∏è Attention, vous allez valider <span style="color: #facc15; font-weight: bold;">${value} points</span> pour le chapitre "${chapter.title}".
    `;
    
    document.getElementById('confirmModal').classList.remove('hidden');
}

function closeConfirmModal() {
    document.getElementById('confirmModal').classList.add('hidden');
    pendingScore = null;
}

document.getElementById('confirmBtn').addEventListener('click', function() {
    if (!pendingScore) return;
    
    scores[pendingScore.chapterId] = pendingScore.value;
    DB.updateUserScore(currentUser.pseudo, scores);
    
    closeConfirmModal();
    updateScores();
    renderChapters();
});

// Mise √† jour des scores
function updateScores() {
    const total = Object.values(scores).reduce((a, b) => a + b, 0);
    document.getElementById('headerScore').textContent = total;
    document.getElementById('totalScore').textContent = total;
}

// Stats
function renderStats() {
    const users = DB.getUsers();
    const myTotal = Object.values(scores).reduce((a, b) => a + b, 0);
    
    const userTotalScores = users.map(u => ({
        pseudo: u.pseudo,
        total: Object.values(u.scores || {}).reduce((a, b) => a + b, 0)
    })).sort((a, b) => b.total - a.total);
    
    const globalAverage = userTotalScores.length > 0
        ? userTotalScores.reduce((a, b) => a + b.total, 0) / userTotalScores.length
        : 0;
    
    document.getElementById('totalPlayers').textContent = users.length;
    document.getElementById('myTotalScore').textContent = myTotal;
    document.getElementById('statsScore').textContent = myTotal;
    document.getElementById('avgScore').textContent = globalAverage.toFixed(1);
    
    document.getElementById('myScoreBar').style.width = `${(myTotal / 100) * 100}%`;
    document.getElementById('avgScoreBar').style.width = `${(globalAverage / 100) * 100}%`;
    
    // Top 10
    const top10Container = document.getElementById('top10Container');
    top10Container.innerHTML = '';
    
    userTotalScores.slice(0, 10).forEach((user, index) => {
        const isCurrentUser = user.pseudo === currentUser.pseudo;
        const medal = index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : '';
        const rank = index === 0 ? '1er' : index === 1 ? '2√®me' : index === 2 ? '3√®me' : `${index + 1}√®me`;
        
        const userDiv = document.createElement('div');
        userDiv.style.cssText = `
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 0.75rem;
            transition: all 0.3s;
            background: ${isCurrentUser ? '#713f12' : '#3f3f46'};
            border: 2px solid ${isCurrentUser ? '#facc15' : '#78350f'};
            ${isCurrentUser ? 'transform: scale(1.05);' : ''}
        `;
        
        userDiv.innerHTML = `
            <div style="display: flex; align-items: center; gap: 1rem; flex: 1; min-width: 0;">
                <div style="width: 2.5rem; height: 2.5rem; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 0.875rem; flex-shrink: 0; ${
                    index < 3 ? 'background: linear-gradient(to bottom right, #facc15, #d97706); color: black;' : 'background: #52525b; color: #fcd34d;'
                }">
                    ${medal || `#${index + 1}`}
                </div>
                <div style="min-width: 0; flex: 1;">
                    <div style="display: flex; align-items: center; gap: 0.5rem; flex-wrap: wrap;">
                        <span style="font-size: 0.75rem; font-weight: bold; padding: 0.25rem 0.5rem; border-radius: 0.25rem; white-space: nowrap; ${
                            index < 3 ? 'background: linear-gradient(to right, #ca8a04, #d97706); color: black;' : 'background: #52525b; color: #fbbf24;'
                        }">
                            ${rank}
                        </span>
                        <div style="font-weight: bold; font-size: 1rem; color: ${isCurrentUser ? '#fde047' : '#fef3c7'}; overflow: hidden; text-overflow: ellipsis;">
                            ${user.pseudo}
                            ${isCurrentUser ? '<span style="margin-left: 0.5rem; font-size: 0.75rem;">(VOUS)</span>' : ''}
                        </div>
                    </div>
                </div>
            </div>
            <div style="font-size: 1.5rem; font-weight: bold; margin-left: 0.5rem; flex-shrink: 0; color: ${isCurrentUser ? '#fde047' : '#facc15'};">
                ${user.total}
                <span style="font-size: 0.875rem; color: #fcd34d; margin-left: 0.25rem;">pts</span>
            </div>
        `;
        
        top10Container.appendChild(userDiv);
    });
}
</script>

</body>
</html>
